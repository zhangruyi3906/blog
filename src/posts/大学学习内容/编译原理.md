---
title: 编译原理
date: 2024-04-04
category:
  - 草稿
tag:
  - 草稿
---
# 编译原理

# 第一节 引论

编译的过程：
1. 词法分析
2. 语法分析
3. 语义分析与中间代码生成
4. 优化器
5. 目标代码生成

步骤：源程序->词法分析->语法分析->语义分析->中间代码生成->优化->目标代码生成->目标程序

编译程序的基本组成：
编译前端:与源语言有关，包括词法分析、语法分析、语义分析、中间代码生成
编译后端:与目标机器有关，包括目标代码生成、优化
趟程(遍)：编译程序对源程序的扫描和分析过程，每一趟都是对源程序的一次扫描和分析

编译程序的分遍决定因素：
（1）计算机存贮容量大小；
（2）编译程序功能强弱；
（3）源语言繁简；
（4）目标程序优化程度；
（5）设计和实现编译程序时使用工具的先进性
（6）参加人员多少和素质等。

自编译程序：用一种语言编写的编译程序，用于编译该语言的源程序。
自展：利用自编译技术，将一个功能较小的编译程序编译成一个功能较大的编译程序。
交叉编译：在一台计算机上编译另一台计算机的程序。

# 第二章 高级语言及其描述语法
一个程序设计语言是一个记号系统，其完整的定义应该包括语法和语义两个方面。
语法：指一组规则，用它可以形成和产生一个合适的程序上下文无关文法
## 程序设计语言的描述 
字母表：
+ 元素的非空有限集，记为$\sum$。例： $\sum{\{a,b,c\}}$
+ 字母表中的元素称为符号。例： a，b，c，字母表包含了语言中所允许出现的所有符号

符号串：
+ 符号的有穷序列。例：a, aa, ac, abc，..，无任何符号的符号串称为空符号串，记为$\varepsilon$
+ 符号串的长度：符号串中符号的个数。例：|abc|=3, |$\varepsilon$|=0
+ 符号串的连接：设x和y是两个符号串，则称x和y的连接为xy。例：abc和def的连接为abcdef
+ $\varepsilon$是符号串的单位元素，对于任何符号串x，有$\varepsilon$x=x$\varepsilon$=x
+ 符号串集合的乘积：令A、B为符号串集合，定义符号串集合乘积 $AB=\{xy|x\in A,y\in B\}$
+ 符号串集合的方幂：令A为符号串集合，定义符号串集合的方幂$A^0=\{\varepsilon\},A^1=A,A^2=AA,...,A^n=AA...A(n个A)$
+ 符号串集合的正闭包：$A^+=A^1\cup A^2\cup A^3\cup ...A^n\cup ...$
+ 符号串集合的闭包：$A^*=A^0\cup A^1\cup A^2\cup ...A^n\cup ...$

文法：是定义或描述语法结构一组形式规则
语法分析树：
![123](https://s2.loli.net/2024/04/04/8JfWbjwDc2stPQ9.webp)


## 上下文无关文法 

### 文法G
上下文无关文法:包括四个部分
+ 一组终结符号
+ 一组非终结符号
+ 一个开始符号
+ 一组产生式


形式化定义：
文法定义成一个四元组$G=(V_N,V_T,P,S)$，其中：
+ $V_N$是非终结符号集合
+ $V_T$是终结符号集合
+  $P$是产生式集合
+  $S$是开始符号
+ 其中，$V_N \cap V_T =  \phi$，$V_N \cup V_T \cup \{S\}$是$V_N,V_T,S$的并集
+ $P$中的产生式是$V_N \rightarrow \alpha$或$V_T \rightarrow \beta$的形式

文法的分类:
+ 0型（无限制文法）：$G=(V_N,V_T,P,S)$，$\alpha \rightarrow \beta; $,$\alpha$中至少有一个非终结符号。
+ 1型（上下文有关文法）：$G=(V_N,V_T,P,S)$，$\alpha \rightarrow \beta; $,$\alpha \rightarrow  \beta$ 有$1 \leq |\alpha| \leq |\beta|$,规则形式:$\gamma_1A\gamma2 \rightarrow \gamma1 \beta \gamma2$
+ 2型（上下文无关文法）：规则形式：$A \rightarrow \alpha$
+ 3型（左线性文法）：规则形式：$A \rightarrow \alpha A$ 或
$A \rightarrow  \alpha$
+ 3型（右线性文法）：规则形式：$A \rightarrow A \alpha$ 或者
$A \rightarrow  \alpha$
+ 正规文法(右线性文法)：
  
上下文无关文法定义的语言:
+ 从文法的开始符号出发，反复使用产生式，对非终结符进行替换和展开，直至推导出语言的各种句子来

### 推导和归约

推导和规约:
+ 推导、最左推导、最右推导、规范推导
+ 归约、最左归约、最右归约、规范归约

推导：
+ 推导：如果存在一个直接推导序列𝑉 = 𝛼0 ⇒ 𝛼1 ⇒ 𝛼2 ⇒ ⋯ ⇒ 𝛼𝑛= 𝑊(𝑛 > 0)，则称符号
串W为符号串V的一个推导，或称“W可归约到V记为𝑉 ⇒
+ 最左推导：在推导过程中，每次都选择最左边的非终结符号进行替换
+ 最右推导：在推导过程中，每次都选择最右边的非终结符号进行替换

规范推导：
+ 最右直接推导又称为规范直接推导
+ 最右推导又称为规范推导

### 句型、句子、语言L的定义
句型： 设$S$是文法$G$的识别符号串，如果$S$中的每个符号都是$G$的终结符号或非终结符号，则称$S$是$G$的一个句型
句子： 如果一个句型中的每个非终结符号都能推导出一个终结符号串，则称这个句型是一个句子
语言： 一个文法的所有句子的集合称为这个文法所描述的语言

### 文法等价
文法等价：两个文法$G_1$和$G_2$是等价的，如果它们描述的语言是相同的
若$L(G_1)=L(G_2)$，则称$G_1$和$G_2$是等价的

### 语法分析树

语法树的根结由文法开始符号标记。随着推导的进行，当某个非终结符被它的候选式所替换时，此非终结符生出其下一代新结，候选式中自左至右没有符号对应着一个新结。这个过程一直持续到所有的非终结符都被替换为终结符为止。这时，语法树的叶结就是终结符，而树的内部结就是非终结符。


![20240406225320](https://s2.loli.net/2024/04/06/tOlPAhmvSuIYbKT.webp)

文法的二义性：一个文法，如果它的一个句子有两棵或两棵以上的语法树，则称此句子具有二义性。如果一个文法含有二义性的句子，则该文法具有二义性。


## 词法分析

### 词法分析的主要任务
词法分析程序的主要功能是从左到右地依次读入源程序的字符，根据所读入字符和该语言的词法规则识别出一个个单词。
+ 词法分析程序的主要功能是从左到右地依次读入源程序的字符，根据所读入字符和该语言的词法规则识别出一个个单词。
+ 识别单词。扫描源程序的一个个字符，按照语言的词法规则，识别出各类有独立意义的 单词。
+ 对识别出来的单词进行内部编码。将长度不一、种类不同的单词用长度统一、格式规整、 分类清晰的内部编码表示。
+ 建立各种表格（如名字特征表、常数表等）。


### 单词的分类与表示
（1）关键字：如 begin，repeat ，if,...
（2）界限符：逗号、分号、括号和空白
（3）运算符： + ， - ， * ， / ，...
（4）常数：各种类型的常数
（5）标识符—表示各种名字：如变量名、数组名和过程名

分类与编码：
+ 类别编码和单词自身编码


### 手动编写词法分析程序

手动编写词法分析程序
转换图实际上是一个有限方向图，图中结点代表状态，用圆圈表示。状态之间用箭弧连接，箭弧上标记（字符如x, y）代表在当前状态下可能出现的输入字符。
![20240406230946](https://s2.loli.net/2024/04/06/gVyMjckzZvENG8L.webp)

左线性文法构造转换图：
![20240406231156](https://s2.loli.net/2024/04/06/hNTOWsHun6gjiql.webp)

右线性文法构造转换图：![20240406231254](https://s2.loli.net/2024/04/06/MJScHaZnQ7svoiX.webp)

### 自动生成词法分析程序的原理
正规表达式： 用来表示字母表$\sum$上字符串集合$\sum^{*}$某些子集，经过运算符组合成的一个有意义的集合运算式


正规表达式递归定义：
+ (e1)是正规式，正规集$L((e_1))=L(e_1)$
+ $e_1|e_2$ 是正规式，正规集$L(e_1|e_2)=L(e_1)\cup L(e_2)$
+ $e_1e_2$ 是正规式，正规集$L(e_1e_2)=L(e_1) L(e_2)$
+ $(e_1)*$ 是正规式，正规集$L((e_1)*)=(L(e_1))* $

正规表达式的性质 
+ 交换律 $e_1|e_2=e_2|e_1$

+ $\sum$上的某些集合若不能用正规式表示，则该集合不是正规集

### 确定的有穷自动机
Deterministic Finite Automaton（DFA）
有穷自动机是对状态转换图进一步形式化描述，这对词法分析程序的构造，特别是对词法分析程序的自动生成将带来很大的方便。

![20240407102111](https://s2.loli.net/2024/04/07/PVl7jMqthcs5HGR.webp)

例子：
![20240407102234](https://s2.loli.net/2024/04/07/6Hkz4NWeA8ibCYo.webp)

输入abb，可以到达C。

对于输入字符串abb，从初始状态E出发，M(E, abb)=M(M(E, a), bb)=M(A, bb)=M(M(A, b), b)=M(B, b)=C最后到达状态C，而C∈{C}，所以abb为此DFA所接受。



![20240407102349](https://s2.loli.net/2024/04/07/Q4BMjgS8q6fJYIc.webp)


### 非确定的有穷自动机
Nondeterministic Finite Automaton（简称NFA）


![20240407102422](https://s2.loli.net/2024/04/07/8ydqmGciEwb4oeY.webp)

$2^k$
![20240407102744](https://s2.loli.net/2024/04/07/pmzEBnSheJWgLqb.webp)

定理：因此，对于任一个(NFA)M，我们总能构造出与其等价的(DFA)M′

穷举法：
![20240407103657](https://s2.loli.net/2024/04/07/j6ngQVH2D5imb9t.webp)

子集法：
![20240407103856](https://s2.loli.net/2024/04/07/TbWm79i5gIKNto4.webp)

![20240407103906](https://s2.loli.net/2024/04/07/wxRC4JjvLiykP6F.webp)![20240407120045](https://s2.loli.net/2024/04/07/aLf3YZWynSmzx4g.webp)


状态转换图逆向地写出正规文法：
![20240407104030](https://s2.loli.net/2024/04/07/zmeclow69XBJupH.webp)

左右线性文法的等价转换
![20240407120509](https://s2.loli.net/2024/04/07/CZRgXAwSOieJfo9.webp)
![20240407120550](https://s2.loli.net/2024/04/07/vlECnP8kdQXqFc6.webp)

正规文法转正规表达式：

![](https://s2.loli.net/2024/04/07/ktQV4fWBhFxa6Es.webp)
### 正规表达式转DFA

步骤：`正规表达式=>构造NFA=>DFA`



![20240407121259](https://s2.loli.net/2024/04/07/KzlnChuTFdwOfYN.webp)
![20240407121427](https://s2.loli.net/2024/04/07/KPme1N2icAEgFGT.webp)

特点：
![20240407121645](https://s2.loli.net/2024/04/07/NTyU73ZYJmKnki1.webp)

转换例子:
![20240407124602](https://s2.loli.net/2024/04/07/5j4vyiVd7tQ2I8P.webp)

s-closure:
![20240407124846](https://s2.loli.net/2024/04/07/vY7cfOUwjEGno4y.webp)

![20240407125125](https://s2.loli.net/2024/04/07/Pl7OE5Mf8ZDdXNr.webp)

步骤：
![20240407125301](https://s2.loli.net/2024/04/07/2OqA41aZ7BukjMV.webp)

### 确定的有穷自动机化简

![20240407125430](https://s2.loli.net/2024/04/07/naqYfsKHSx9P3he.webp)

等价：对于一个给定的（DFA）M，假定有两个不相同状态Ｓ１和Ｓ２，如果从状态Ｓ１出发能扫描符号串w
而停止于终态，同样，从状态Ｓ２出发也能扫描符号串w而停止于终态，反之亦然，我们则称状态Ｓ１和Ｓ２
是等价的 。
可区分：若两不同状态不等价，则称它们是可区分的。

化简方法：
把（DFA）Ｍ的状态集分别划成一些不相交子集，使得任何不同的两个子集的状态是可区分的，而同一子集中的任何两个状态是等价的。
化简步骤：
![20240407125844](https://s2.loli.net/2024/04/07/HLWcfMFDCtOYqPd.webp)
例子：
![20240407125911](https://s2.loli.net/2024/04/07/8lwjnQe2ofk5uaA.webp)
